{% extends "base.html" %}
{% block content %}
<h2> Job Summary </h2>
{% set MAJOR_STATII = ['New','Submitted','Running','Suspended','Done','Failed','Terminated'] %}
{% set keys = ['Name','Site','Type','Release Tag','#events']+MAJOR_STATII+["Total"] %}
<table class="table">
	<thead>
		{% for key in keys %}
		<th>{{ key }}</th>
		{% endfor %}
	</thead>
		{% for job in jobs %}
	<tr>
		<td><a href="{{ url_for('jobs.detail', slug=job.slug) }}">{{ job.title }}</a></td>
		<td>{{ job.execution_site }}</td>
		<td>{{ job.type }}</td>
		<td>{{ job.release }}</td>
		<td>{{ job.getNevents() }}</td>
		{% set statdict = job.aggregateStatiiFast(asdict=True) %}
		{% for key in MAJOR_STATII %}
		{% set value = statdict[key] %}
		<td><a href={{ url_for('jobs.detail', slug=job.slug, status={{ value }} }}">{{ value }}</a></td>
		{% endfor %}
		<td>{{job.countInstances()}}</td>
	</tr>	
	{% endfor %}
</table>

{% endblock %}
